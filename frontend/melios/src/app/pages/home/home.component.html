<div *ngIf="isLoading" class="loading-spinner">
    <!-- Hiển thị một spinner hoặc một thông báo khi dữ liệu đang được tải -->
    <p>Loading...</p>
</div>

<div *ngIf="!isLoading">
    <div class="text-left">
        <h1 class="mb-5 text-2xl sm:text-4xl text-black font-bold">
            Recommend
        </h1>
    </div>
    <div id="controls-carousel" class="relative w-full" data-carousel="static">
        <!-- Carousel wrapper -->
        <div class="relative h-56 overflow-hidden rounded-lg md:h-96 sm:h-full">
            <!-- Item 1 -->
            <div class="bg-black flex items-end justify-end overflow-hidden duration-700 ease-in-out"
                data-carousel-item>
                <a [routerLink]="['/products', gameList[0]?.game_id]">
                    <div class="lg:block hidden w-1/3 items-center p-4 bg-slate-300 rounded">
                        <h1 class="text-black text-3xl">{{gameList[0]?.game_name}}</h1>
                        <h1 class="text-black">{{gameList[0]?.description}}</h1>
                    </div>
                    <img [src]="gameList[0]?.base_view"
                        class="object-contain h-full absolute block md:-translate-x-[50%]  sm:-translate-x-[50%] lg:-translate-x-[20%] -translate-y-1/2 top-1/2 left-1/2"
                        alt="...">
                </a>
            </div>

            <div class="bg-black flex items-end justify-end overflow-hidden duration-700 ease-in-out"
                data-carousel-item>
                <a [routerLink]="['/products', gameList[1]?.game_id]">
                    <div class="lg:block hidden w-1/3 items-center p-4 bg-slate-300 rounded">
                        <h1 class="text-black text-3xl">{{gameList[1]?.game_name}}</h1>
                        <h1 class="text-black">{{gameList[1]?.description}}</h1>
                    </div>
                    <img [src]="gameList[1]?.base_view"
                        class="object-contain h-full absolute block   sm:-translate-x-[50%] lg:-translate-x-[20%] -translate-y-1/2 top-1/2 left-1/2"
                        alt="...">
                </a>
            </div>

            <div class="bg-black flex items-end justify-end overflow-hidden duration-700 ease-in-out"
                data-carousel-item>
                <a [routerLink]="['/products', gameList[2]?.game_id]">
                    <div class="lg:block hidden w-1/3 items-center p-4 bg-slate-300 rounded">
                        <h1 class="text-black text-3xl">{{gameList[2]?.game_name}}</h1>
                        <h1 class="text-black">{{gameList[2]?.description}}</h1>
                    </div>
                    <img [src]="gameList[2]?.base_view"
                        class="object-contain h-full absolute block   sm:-translate-x-[50%] lg:-translate-x-[20%] -translate-y-1/2 top-1/2 left-1/2"
                        alt="...">
                </a>
            </div>

            <div class="bg-black flex items-end justify-end overflow-hidden duration-700 ease-in-out"
                data-carousel-item>
                <a [routerLink]="['/products', gameList[3]?.game_id]">
                    <div class="lg:block hidden w-1/3 items-center p-4 bg-slate-300 rounded">
                        <h1 class="text-black text-3xl">{{gameList[3]?.game_name}}</h1>
                        <h1 class="text-black">{{gameList[3]?.description}}</h1>
                    </div>
                    <img [src]="gameList[3]?.base_view"
                        class="object-contain h-full absolute block   sm:-translate-x-[50%] lg:-translate-x-[20%] -translate-y-1/2 top-1/2 left-1/2"
                        alt="...">
                </a>
            </div>

            <div class="bg-black flex items-end justify-end overflow-hidden duration-700 ease-in-out"
                data-carousel-item>
                <a [routerLink]="['/products', gameList[4]?.game_id]">
                    <div class="lg:block hidden w-1/3 items-center p-4 bg-slate-300 rounded">
                        <h1 class="text-black text-3xl">{{gameList[4]?.game_name}}</h1>
                        <h1 class="text-black">{{gameList[4]?.description}}</h1>
                    </div>
                    <img [src]="gameList[4]?.base_view"
                        class="object-contain h-full absolute block   sm:-translate-x-[50%] lg:-translate-x-[20%] -translate-y-1/2 top-1/2 left-1/2"
                        alt="...">
                </a>
            </div>

        </div>
        <!-- Slider controls -->
        <button type="button"
            class="absolute top-0 start-0 z-30 flex items-center justify-center h-full px-4 cursor-pointer group focus:outline-none"
            data-carousel-prev>
            <span
                class="inline-flex items-center justify-center w-10 h-10 rounded-full bg-white/30 dark:bg-gray-800/30 group-hover:bg-white/50 dark:group-hover:bg-gray-800/60 group-focus:ring-4 group-focus:ring-white dark:group-focus:ring-gray-800/70 group-focus:outline-none">
                <svg class="w-4 h-4 text-white dark:text-gray-800 rtl:rotate-180" aria-hidden="true"
                    xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 6 10">
                    <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                        d="M5 1 1 5l4 4" />
                </svg>
                <span class="sr-only">Previous</span>
            </span>
        </button>
        <button type="button"
            class="absolute top-0 end-0 z-30 flex items-center justify-center h-full px-4 cursor-pointer group focus:outline-none"
            data-carousel-next>
            <span
                class="inline-flex items-center justify-center w-10 h-10 rounded-full bg-white/30 dark:bg-gray-800/30 group-hover:bg-white/50 dark:group-hover:bg-gray-800/60 group-focus:ring-4 group-focus:ring-white dark:group-focus:ring-gray-800/70 group-focus:outline-none">
                <svg class="w-4 h-4 text-white dark:text-gray-800 rtl:rotate-180" aria-hidden="true"
                    xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 6 10">
                    <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                        d="m1 9 4-4-4-4" />
                </svg>
                <span class="sr-only">Next</span>
            </span>
        </button>
    </div>
    <div class="text-left py-6">
        <h1 class="mb-5 text-2xl sm:text-4xl text-black font-bold">
            New
        </h1>
    </div>
    <div class="flex flex-wrap -mx-3">
        <div class="w-full md:w-1/4 px-3 mt-3" *ngFor="let item of allGameList">
            <div
                class="w-full max-w-sm min-h-full bg-black border border-gray-200 rounded-lg shadow dark:bg-black dark:border-gray-700 flex flex-col">
                <!-- Game Image -->
                <a [routerLink]="['/products', item.game_id]">
                    <div class="h-48 w-full overflow-hidden rounded-t-lg">
                        <img class="h-full w-full object-cover" [src]="item.base_view" alt="product image" />
                    </div>
                </a>

                <!-- Game Info -->
                <div class="px-5 pb-5 mt-auto">
                    <!-- Game Name -->
                    <a href="#">
                        <h5 class=" mt-5 text-xl font-semibold tracking-tight text-gray-300 dark:text-white">
                            {{ item.game_name }}
                        </h5>
                    </a>

                    <!-- Game Price and Add to Cart -->
                    <div class="flex items-center  justify-between mt-3">
                        <div class="flex flex-col">
                            <span class="text-gray-500 line-through" *ngIf="item?.game_price">{{item.game_price|
                                number}}</span>
                            <div *ngIf="item.stock > 0 else outOfStock">
                                <span class="text-xl font-bold mr-2 text-red-300">
                                    {{ item.final_game_price | number }}đ
                                </span>


                            </div>
                        </div>
                        <button [disabled]="item.stock <= 0" (click)="onAddToCart(item.game_id)"
                            class="text-white disabled:bg-gray-300 disabled:line-through disabled:text-black bg-gray-700 hover:bg-gray-800 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center dark:bg-gray-600 dark:hover:bg-gray-700 dark:focus:ring-gray-800">
                            Add to cart
                        </button>
                        <ng-template #outOfStock>
                            <span class="text-xl text-red-300">Out of stock</span>
                        </ng-template>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>